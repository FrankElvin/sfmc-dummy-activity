<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Multi-Channel Activity</title>
    <!-- SFMC / Lightning Styles -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/design-system/2.14.0/styles/salesforce-lightning-design-system.min.css" />
    <style>
        body { padding: 0; margin: 0; background-color: #fff; height: 100vh; display: flex; flex-direction: column; }
        .step-container { padding: 20px; display: none; flex: 1; overflow-y: auto; }
        .step-container.active { display: block; }

        /* Layout */
        .config-wrapper { display: flex; gap: 20px; height: 100%; }
        .left-col { width: 30%; border-right: 1px solid #dddbda; padding-right: 15px; overflow-y: auto; }
        .right-col { width: 70%; overflow-y: auto; padding-bottom: 50px; }

        /* Chips for Fields */
        .field-chip {
            display: block; background: #f3f2f2; padding: 5px 10px; margin-bottom: 5px;
            cursor: pointer; border-radius: 4px; font-size: 12px; border: 1px solid #e1e1e1;
        }
        .field-chip:hover { background-color: #0176d3; color: white; }

        /* Dynamic List Items */
        .dynamic-item { border: 1px solid #dddbda; padding: 10px; margin-bottom: 10px; border-radius: 4px; position: relative; }
        .remove-btn { position: absolute; top: 5px; right: 5px; color: red; cursor: pointer; font-size: 0.8em; }
        .img-preview { max-width: 100px; max-height: 100px; display: block; margin-top: 5px; border: 1px solid #ccc; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

<!-- STEP 1: Channel Selection -->
<div id="step1" class="step-container active">
    <div class="slds-form-element slds-size_1-of-2">
        <label class="slds-form-element__label" for="channel-select">
            <abbr class="slds-required" title="required">* </abbr>Select Channel
        </label>
        <div class="slds-form-element__control">
            <div class="slds-select_container">
                <select class="slds-select" id="channel-select">
                    <option value="">-- Choose --</option>
                    <option value="sms">SMS</option>
                    <option value="viber">Viber</option>
                    <option value="push">Push Notification</option>
                </select>
            </div>
        </div>
    </div>
</div>

<!-- STEP 2: Configuration -->
<div id="step2" class="step-container">
    <div class="config-wrapper">

        <!-- Left: Fields (Shared) -->
        <div class="left-col">
            <div class="slds-text-heading_small slds-m-bottom_small">Entry Data</div>
            <div id="field-list"><p>Loading schema...</p></div>
        </div>

        <!-- Right: Dynamic Form -->
        <div class="right-col">

            <!-- SECTION: Message Title (Push Only) -->
            <div id="group-title" class="slds-form-element slds-m-bottom_medium hidden">
                <label class="slds-form-element__label">Message Title</label>
                <div class="slds-form-element__control">
                    <input type="text" id="msg-title" class="slds-input inject-target" placeholder="Enter title..." />
                </div>
            </div>

            <!-- SECTION: Message Template (All) -->
            <div id="group-template" class="slds-form-element slds-m-bottom_medium">
                <label class="slds-form-element__label">Message Text</label>
                <div class="slds-form-element__control">
                    <textarea id="msg-template" class="slds-textarea inject-target" rows="4" placeholder="Hello {{Name}}..."></textarea>
                </div>
            </div>

            <!-- SECTION: Images (Viber & Push) -->
            <div id="group-images" class="slds-m-bottom_medium hidden">
                <div class="slds-text-heading_small slds-m-bottom_x-small">Images</div>
                <div id="image-list-container"></div>
                <button class="slds-button slds-button_neutral slds-m-top_x-small" id="btn-add-image">+ Add Image</button>
            </div>

            <!-- SECTION: Buttons (Viber & Push) -->
            <div id="group-buttons" class="slds-m-bottom_medium hidden">
                <div class="slds-text-heading_small slds-m-bottom_x-small">Buttons (Max 2)</div>
                <div id="button-list-container"></div>
                <button class="slds-button slds-button_neutral slds-m-top_x-small" id="btn-add-button">+ Add Button</button>
            </div>

        </div>
    </div>
</div>

<!-- Libraries -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="js/postmonger.js"></script>
<script src="js/customActivity.js"></script>
</body>
</html>
